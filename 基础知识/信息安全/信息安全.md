1. **ARP协议问题。**

2. 1. **ARP协议的作用是什么。**

      ARP，即地址解析协议，实现通过IP地址得知其物理地址。通过广播获取正确的映射信息。

   2. **引入ARP缓存的功能是什么。**

      目的是：下次再要访问ARP高速缓存中的IP地址的主机时，不需要再次发送ARP请求去获取MAC地址。直接从高速缓存中读取就可以了。可以有效缓解链路的压力。

   3. **ARP缓存中毒的攻击方法和效果是什么。**

      要实现ARP缓存中毒，如果被攻击者的ARP表不是动态更新的，而是绑定死的，需先删除相关ARP表项，攻击者再对其进行MAC地址和IP地址映射绑定，并广播ARP数据包，使所有接收到ARP数据包的用户，生成新的ARP表，在ping被攻击者IP时，因为IP绑定的是错误的MAC地址，而无法ping通，这是利用了ARP中毒缓存进行拒绝服务攻击。同时，也可以进行ARP欺骗进行中间人攻击，将所有流量都转发到自己机器上，对数据进行嗅探。

3. **IP协议安全问题**

4. 1. **为什么IP要进行分片？**

      主要是因为硬件环境的MTU限制。一个IP报文最多可以达到65535的最大长度；但是网络硬件限制了帧的大小（以太网限制为1500字节）。

   2. **IP分片如何进行重组？**

      通过对IP头部的DF\MF标志位和分片偏移来对分散的ip片进行重组

   3. **泪滴攻击（teardrop）的原理是什么？**

      泪滴攻击(TearDrop)指的是向目标机器发送损坏的IP包，诸如重叠的包或过大的包载荷。借由这些手段，该攻击可以通过TCP/IP协议栈中分片重组代码中的bug来瘫痪各种不同的操作系统。

   4. **包过滤防火墙，通过过滤SYN包，防止外部链接。攻击者可以如何绕过这个过滤？**

      

5. **ICMP协议安全。**

6. 1. **什么是SMURF攻击？如何防止？**

      Smurf攻击是一种分布式拒绝服务攻击，其中使用IP广播地址将具有预期受害者的欺骗源IP的大量互联网控制消息协议（ICMP）分组广播到计算机网络。 默认情况下，网络上的大多数设备都会通过向源IP地址发送回复来对此做出响应。 如果网络上接收和响应这些数据包的机器数量非常大，受害者的计算机将忙于处理ping回复包。 这可能会使受害者的计算机变慢，无法继续工作。

      防御：

      1. 配置各个主机和路由器不响应ICMP请求或广播；

      2. 配置路由器不转发定向到广播地址的数据包。 直到1999年，标准要求路由器默认转发此类数据包。 从那时起，默认标准被更改为不转发此类数据包。

   2. **什么是ICMP重定向攻击？如何防止？**

      ICMP重定向信息是路由器向主机提供实时的路由信息，当一个主机收到ICMP重定向信息时，它就会根据这个信息来更新自己的路由表。由于缺乏必要的合法性检查，如果一个黑客想要被攻击的主机修改它的路由表，黑客就会发送ICMP重定向信息给被攻击的主机，让该主机按照黑客的要求来修改路由表。

      ICMP重定向防御：

      （1）网关端：

      ·关闭ICMP重定向（no ip redirects）。

      ·变长子网掩码划分网段。

      ·使用网络控制列表（ACL）和代理。

      （2）主机端：

      可以使用防火墙等过滤掉ICMP报文，或使用反间谍软件监控。

      结合防ARP、IP欺骗等进行防御。 

7. **TCP协议安全。**

8. 1. **什么是SYN flooding攻击？效果是什么？如何防止？**

      SYN flooding之前也讨论过，发生这种攻击的原因是因为TCP三次握手过程中的一个设计。当应用开放了一个TCP端口后，该端口就处于侦听状态，不停地监视发到该端口的Syn报文，一旦接收到Syn报文，就需要为即将建立的TCP连接分配TCB（Transmission Control Block），通常一个TCB至少需要280个字节，在某些操作系统中TCB甚至达到1300个字节；并且进入半开连接（half-opening）状态，也即收到SYN包而还未收到ACK包时的连接状态。操作系统实现的最多可开启的半开连接个数是一定的，譬如512，而受到内存的限制，可能还达不到这个数字。如果半开连接的个数过多，就会消耗掉可用的内存，使得新的正常的连接请求不能被处理。

      防御方法

      1. 封IP
      2. SYN Cache：每次来了SYN包，那么就在SYNCache队列中生成一个项，保持一些基本信息；然后在收到ACK时检查SYNCache队列，如果能找到合适的项，那么开始建立TCP连接，然后删除SYNcache中的项。
      3. SYN Cookie

   2. **端口扫描的原理是什么？**

      nmap的工作原理就是它会首先一个个地尝试与一些端口的连接，如果端口有响应，并且能够建立起连接，那么nmap就能够判断得出来，这个端口是open的。

      注：一旦建立连接，对方主机的log就会记录下来，如果在接收到SYN+ACK数据包之后不回复ACK，而是回复RST，那么既可以判断出来这个端口是开放的，同时又能够不留下痕迹。

   3. **namp -sS和nmap -sT的区别是什么？**

      ```
      namp -sS利用基本的SYN扫描方式探测其端口开放状态。
      使用频率最高的扫描选项：SYN扫描,又称为半开放扫描，它不打开一个完全的TCP连接，执行得很快，效率高
      （一个完整的tcp连接需要3次握手，而-sS选项不需要3次握手）
      Tcp SYN Scan (sS) 它被称为半开放扫描
      优点：Nmap发送SYN包到远程主机，但是它不会产生任何会话，目标主机几乎不会把连接记入系统日志。（防止对方判断为扫描攻击），扫描速度快，效率高，在工作中使用频率最高
      缺点：它需要root/administrator权限执行
      ```

      ```text
      nmap -sT：3次握手方式tcp的扫描（默认）
      Tcp connect() scan (sT)和上面的Tcp SYN 对应，TCP connect()扫描就是默认的扫描模式.
      不同于Tcp SYN扫描,Tcp connect()扫描需要完成三次握手,并且要求调用系统的connect().
      优点：你勿需root权限。普通用户也可以使用。
      缺点：这种扫描很容易被检测到，在目标主机的日志中会记录大批的连接请求以及错误信息，由于它要完成3次握手，效率低，速度慢，建议使用-sS 
      ```

   4. **nmap -sA扫描的原理是什么？**

      nmap -sA扫描。顾名思义，-sA扫描是通过设置ACK位进行扫描的方法。ACK数据包不会启动会话建立，所以比较隐蔽；同时，因为ACK数据包不会单独出现，所以，对于端口，不管是开放的还是关闭的，如果收到一个不请自来的ACK数据包，都会发一个RST包。那这样的话，ACK扫描就不可能识别端口的开放和关闭情况。那么它有什么用呢？它可以识别端口有没有被过滤。

   5. **nmap idle扫描的原理是什么？**

      1. 向僵尸主机发送SYN/ACK数据包，取得带有分片ID（IPID）的RST报文。
      2. 发送使用僵尸主机IP地址的伪数据包给目标主机。
      3. 如果目标主机端口关闭，就会向僵尸主机响应RST报文。如果目标端口开放，目标主机向僵尸主机响应SYN/ACK报文，僵尸主机发现这个非法连接响应，并向目标主机发送RST报文，此时IPID号开始增长。
      4. 通过向僵尸主机发送另外一个SYN/ACK报文已退出上述循环并检查将是主机RST报文中的IPID是不是每次增长2，同时目标主机的RST每次增长1。
      5. 重复上述步骤直到检测完所有的端口。

9. **防火墙。**

10. 1. **iptables是状态防火墙。状态防火墙相比于包过滤防火墙的优点是什么？**

       包过滤防火墙：包过滤防火墙不检查数据区，包过滤防火墙不建立连接状态表，前后报文无关，应用层控制很弱。
       应用网关防火墙：不检查IP、TCP报头，不建立连接状态表，网络层保护比较弱。
       状态检测防火墙：不检查数据区，建立连接状态表，前后报文相关，应用层控制很弱。

    2. **NAT的作用是什么？**、

       NAT是网络地址转换，使得一个整体机构以一个公用IP地址出现在Internet上。顾名思义，它是一种把内部私有网络地址（IP地址）翻译成合法网络IP地址的技术。因此NAT在一定程度上，能够有效的解决公网地址不足的问题。

    3. **sudo iptables –P INPUT DROP； iptables -A INPUT -p tcp --sport 80 -j ACCEPT 这两条语句的作用是什么？**

       第一条将输入的数据包全部扔掉

       第二条开一个80端口接受TCP请求

11. **Rootkit。**

12. 1. **什么是rootkit？**

       Rootkit的作用在于“能维持root权限的一套工具”。它的目的是隐藏自己以及恶意程序，达到长期在目的主机存在并收集信息的目的。Rootkit一般和后门等程序结合使用，帮忙隐藏后门的踪迹。

    2. **LKM的好处是什么？**

    3. **请描述系统调用劫持的过程。**

    4. **请解释，为何Unix可以做到一切皆文件。**

       使用了VFS技术，虚拟文件系统（Virtual File System, 简称 VFS）， 是 Linux 内核中的一个软件层，用于给用户空间的程序提供文件系统接口；同时，它也提供了内核中的一个 抽象功能，允许不同的文件系统共存。系统中所有的文件系统不但依赖 VFS 共存，而且也依靠 VFS 协同工作。

13. **缓冲区溢出。**

14. 1. **什么是返回地址？**
    2. **汇编语言中，call指令的作用是什么？**
    3. **请描述当函数调用发生时，进程地址空间中栈帧的变化。**
    4. **如何防止缓冲区溢出攻击。**